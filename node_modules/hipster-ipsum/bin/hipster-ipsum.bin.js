#!/usr/bin/env node

var optimist   = require('optimist')
  , generator  = require('./../lib/generator')
  , clipper    = require('./../lib/clipper');

var options    = {}
  , arguments  = optimist.argv
  , hipsterIpsum = '';

// Allow CLI user to run command with plain english. E.g. "hipster-ipsum 1 sentence" or "hipster-ipsum 3 words --copy"
var nakedArguments = arguments._;
if (nakedArguments.length >= 2) {
  arguments.count = nakedArguments[0]; // Clobber count.
  arguments.units = nakedArguments[1]; // Clobber units.
}

options.units  = arguments.units || 'sentences';
options.count  = arguments.count || 1;
options.copy   = arguments.copy ? true : false;
options.format = arguments.format || 'plain';

// Generate the hipster ipsum text and print it out.
hipsterIpsum = generator(options);
console.log(hipsterIpsum);

// Copy the hipster ipsum text to the clipboard.
if (options.copy) {
  clipper(hipsterIpsum, function(err) { err ? process.exit(1) : process.exit() });
} else {
  process.exit(); // Successful exit.
}
